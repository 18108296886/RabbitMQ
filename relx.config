%% vim:ft=erlang:
{release,
 {rabbitmq, "3.13.0"},
 [{mnesia, none},

  rabbit%,

  %{amqp_client, none},
  %{rabbitmq_management_agent, none},
  %{rabbitmq_web_dispatch, none},
  %{rabbitmq_management, none},

  %{prometheus, none},
  %{rabbitmq_prometheus, none},

  %{rabbitmq_stream_common, none},
  %{rabbitmq_stream, none},
  %{rabbitmq_stream_management, none},
  %{rabbitmq_top, none}
 ]}.

{extended_start_script, true}.

{vm_args, "./vm.args.src"}.

{overlay, [{copy, "escript", "escript"},
           {copy, "sbin/rabbitmq-defaults", "bin/rabbitmq-defaults"},
           {copy, "sbin/rabbitmq-env", "bin/rabbitmq-env"},
           {copy, "sbin/rabbitmq-plugins", "bin/rabbitmq-plugins"},
           {copy, "sbin/rabbitmq-diagnostics", "bin/rabbitmq-diagnostics"},
           {copy, "sbin/rabbitmq-queues", "bin/rabbitmq-queues"},
           {copy, "sbin/rabbitmq-streams", "bin/rabbitmq-streams"},
           {copy, "sbin/rabbitmq-upgrade", "bin/rabbitmq-upgrade"},
           {copy, "sbin/rabbitmqctl", "bin/rabbitmqctl"},
           {copy, "migrate-sysconfig.escript", "bin/migrate-sysconfig"},
           {copy, "upgrade.sh", "bin/upgrade"},
           {mkdir, "etc"},
           {mkdir, "etc/rabbitmq"}]}.

{extended_start_script_hooks, [{pre_start, [{custom, "rabbitmq-env"}]}]}.
